<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="EveryTool.io - Free online tools that work entirely in your browser. Protect your privacy while getting things done.">
  <title>EveryTool.io - PDF Tools</title>
  
  <!-- Performance Optimization -->
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- PDF Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <!-- PDF.js for PDF rendering -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
  
  <!-- Shared CSS -->
  <style>
    /* ========== SHARED STYLES ========== */
    :root {
      --primary: #4361ee;
      --primary-dark: #3a56d4;
      --secondary: #7209b7;
      --accent: #f72585;
      --light: #f8f9fa;
      --dark: #212529;
      --gray: #6c757d;
      --light-gray: #e9ecef;
      --border-radius: 12px;
      --box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, var(--light) 0%, #f0f4ff 100%);
      color: var(--dark);
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
      transition: transform 0.4s ease;
    }
    
    body.menu-open {
      overflow: hidden;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header & Navigation */
    header {
      background: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
    }

    .logo {
      display: flex;
      align-items: center;
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary);
      text-decoration: none;
      z-index: 2001;
    }

    .logo i {
      margin-right: 10px;
      font-size: 2.2rem;
    }

    .nav-container {
      display: flex;
      align-items: center;
    }

    .nav-menu {
      display: flex;
      list-style: none;
      margin-right: 20px;
    }

    .nav-item {
      position: relative;
      margin: 0 15px;
    }

    .nav-link {
      padding: 10px 15px;
      color: var(--dark);
      text-decoration: none;
      font-weight: 500;
      border-radius: var(--border-radius);
      transition: var(--transition);
      display: flex;
      align-items: center;
    }

    .nav-link i {
      margin-right: 8px;
    }

    .nav-link:hover, .nav-link:focus {
      background: rgba(67, 97, 238, 0.1);
      color: var(--primary);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    /* Dropdown Menu */
    .dropdown {
      position: relative;
    }

    .dropdown-toggle::after {
      content: '\f078'; /* Font Awesome chevron-down */
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      margin-left: 8px;
      font-size: 0.8rem;
    }

    .dropdown-menu {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      box-shadow: var(--box-shadow);
      border-radius: var(--border-radius);
      min-width: 240px;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      list-style: none;
      padding: 10px 0;
    }

    .dropdown-menu li {
      margin: 0;
    }

    .dropdown-item {
      display: flex;
      align-items: center;
      padding: 10px 20px;
      color: var(--dark);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
    }

    .dropdown-item i {
      margin-right: 10px;
      font-size: 1.2rem;
      color: var(--primary);
    }

    .dropdown-item:hover, .dropdown-item:focus {
      background: rgba(67, 97, 238, 0.1);
      color: var(--primary);
    }

    .nav-item.dropdown:hover .dropdown-menu,
    .nav-item.dropdown .dropdown-menu.active {
      display: block;
    }

    .dropdown-error {
      font-size: 0.9rem;
      color: red;
      padding: 10px 20px;
    }

    .mobile-menu-btn {
      display: none;
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--dark);
      cursor: pointer;
      padding: 10px;
      border-radius: 5px;
      z-index: 2001;
    }

    .mobile-menu-btn:hover, .mobile-menu-btn:focus {
      background: rgba(67, 97, 238, 0.1);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    /* Mobile Menu */
    .mobile-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1999;
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .mobile-backdrop.active {
      display: block;
      opacity: 1;
    }

    .mobile-nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 280px;
      height: 100vh;
      background: white;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      z-index: 2000;
      transform: translateX(-100%);
      transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      overflow-y: auto;
      display: block;
    }

    .mobile-nav.active {
      transform: translateX(0);
    }

    .mobile-nav-header {
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--light-gray);
    }

    .close-mobile-menu {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--dark);
      cursor: pointer;
      padding: 5px;
      border-radius: 5px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-mobile-menu:hover, .close-mobile-menu:focus {
      background: rgba(0, 0, 0, 0.05);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    .mobile-nav-menu {
      list-style: none;
      padding: 20px;
    }

    .mobile-nav-item {
      margin-bottom: 10px;
    }

    .mobile-nav-link {
      display: block;
      padding: 12px 15px;
      color: var(--dark);
      text-decoration: none;
      font-weight: 500;
      border-radius: var(--border-radius);
      transition: var(--transition);
    }

    .mobile-nav-link:hover, .mobile-nav-link:focus {
      background: rgba(67, 97, 238, 0.1);
      color: var(--primary);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    .mobile-nav-link i {
      width: 24px;
      text-align: center;
      margin-right: 10px;
    }

    .mobile-nav .dropdown-menu {
      display: none;
      list-style: none;
      padding: 10px 15px 10px 30px;
      background: rgba(0, 0, 0, 0.05);
    }

    .mobile-nav .dropdown-menu.active {
      display: block;
    }

    .mobile-nav .dropdown-item {
      display: flex;
      align-items: center;
      padding: 8px 20px;
    }

    .mobile-nav .dropdown-item i {
      margin-right: 10px;
      font-size: 1.2rem;
      color: var(--primary);
    }

    .mobile-nav .dropdown-error {
      font-size: 0.9rem;
      color: red;
      padding: 8px 20px;
    }

    /* Footer */
    footer {
      background: linear-gradient(135deg, var(--light) 0%, #f0f4ff 100%);
      color: #000;
      padding: 60px 0 30px;
    }

    .footer-bottom {
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      padding-top: 30px;
      text-align: center;
    }

    .footer-bottom a {
      color: #000;
      text-decoration: none;
      transition: var(--transition);
      font-weight: 600;
      font-size: 1.1rem;
      margin: 0 10px;
    }

    .footer-bottom a:hover, .footer-bottom a:focus {
      color: var(--primary);
      text-decoration: underline;
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    .footer-links-row {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .footer-bottom p {
      color: #000;
      font-weight: 600;
      font-size: 1.1rem;
      margin: 0;
    }

    /* Cookie Consent Styles */
    #cookie-consent {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 95%;
      max-width: 800px;
      background: var(--light);
      border-radius: var(--border-radius);
      box-shadow: 0 5px 30px rgba(0, 0, 0, 0.15);
      padding: 20px;
      z-index: 1000;
      display: none;
    }

    .cookie-content {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
      justify-content: space-between;
    }

    .cookie-text {
      flex: 1;
      min-width: 300px;
      color: var(--dark);
    }

    .cookie-text p {
      margin-bottom: 10px;
      font-size: 0.95rem;
    }

    .cookie-text a {
      color: var(--primary);
      text-decoration: none;
    }

    .cookie-text a:hover, .cookie-text a:focus {
      text-decoration: underline;
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    .cookie-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .cookie-btn {
      padding: 10px 20px;
      border-radius: 50px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      font-size: 0.9rem;
      border: none;
      min-width: 180px;
    }

    .cookie-btn:focus {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    .reject-btn {
      background: var(--light-gray);
      color: var(--dark);
    }

    .reject-btn:hover {
      background: #e0e0e0;
    }

    .accept-btn {
      background: var(--primary);
      color: white;
    }

    .accept-btn:hover {
      background: var(--primary-dark);
    }

    .cookie-settings-btn {
      background: transparent;
      color: var(--gray);
      text-decoration: underline;
      border: none;
      cursor: pointer;
      padding: 0;
      margin-top: 10px;
      font-size: 0.85rem;
    }

    .cookie-settings-btn:hover, .cookie-settings-btn:focus {
      color: var(--dark);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    #cookie-settings {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      animation: fadeIn 0.3s ease-out;
    }

    .settings-modal {
      background: var(--light);
      border-radius: var(--border-radius);
      width: 95%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      padding: 30px;
      position: relative;
      animation: slideUp 0.3s ease-out;
    }

    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .settings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .settings-header h2 {
      font-size: 1.8rem;
      margin: 0;
    }

    .close-settings {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--gray);
      transition: var(--transition);
      padding: 5px;
      border-radius: 5px;
    }

    .close-settings:hover, .close-settings:focus {
      color: var(--dark);
      background: rgba(0, 0, 0, 0.05);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    .settings-content {
      margin-bottom: 20px;
    }

    .cookie-type {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--light-gray);
    }

    .cookie-type-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .cookie-type h3 {
      margin: 0;
      font-size: 1.2rem;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .toggle-switch input {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
      z-index: 1;
    }

    .slider {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--gray);
      transition: background-color 0.3s ease;
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: transform 0.3s ease;
      border-radius: 50%;
    }

    .toggle-switch input:checked + .slider {
      background-color: var(--primary);
    }

    .toggle-switch input:checked + .slider:before {
      transform: translateX(26px);
    }

    .toggle-switch input:focus + .slider {
      box-shadow: 0 0 0 2px var(--primary-dark);
    }

    .toggle-switch input:disabled + .slider {
      background-color: var(--light-gray);
      opacity: 0.5;
      cursor: not-allowed;
    }

    .toggle-switch input:disabled + .slider:before {
      background-color: #ddd;
    }

    .cookie-type p {
      font-size: 0.9rem;
      color: var(--gray);
      margin-bottom: 10px;
    }

    .settings-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .save-settings {
      background: var(--primary);
      color: white;
      border: none;
      padding: 10px 25px;
      border-radius: 50px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
    }

    .save-settings:hover, .save-settings:focus {
      background: var(--primary-dark);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    /* Accessibility Improvements */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .nav-menu {
        display: none;
      }
      
      .mobile-menu-btn {
        display: block;
      }
      
      .mobile-nav {
        width: 100%;
      }
    }

    @media (min-width: 993px) {
      .mobile-nav {
        display: none !important;
      }
      .mobile-backdrop {
        display: none !important;
      }
    }

    @media (max-width: 768px) {
      .footer-links-row {
        flex-direction: column;
        gap: 10px;
      }
      
      .cookie-content {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .cookie-buttons {
        width: 100%;
      }
      
      .cookie-btn {
        width: 100%;
      }
    }

    @media (max-width: 576px) {
      .header-container {
        padding: 15px 0;
      }
      
      .logo {
        font-size: 1.5rem;
      }
      
      .logo i {
        font-size: 1.8rem;
      }
      
      .settings-modal {
        padding: 20px;
      }
    }
    /* ========== END SHARED STYLES ========== */

    /* ========== PDF TOOLS SPECIFIC STYLES ========== */
    /* Main Header Section */
    .main-header {
      text-align: center;
      padding: 50px 0 30px;
    }

    .main-header .logo {
      font-size: 4rem;
      margin-bottom: 15px;
      color: var(--primary);
      display: inline-block;
      animation: pulse 2s infinite;
      justify-content: center;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .main-header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      font-weight: 700;
      color: var(--dark);
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .tagline {
      font-size: 1.2rem;
      color: var(--gray);
      max-width: 700px;
      margin: 0 auto 25px;
    }

    /* Features Grid */
    .features-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 30px;
      margin: 40px auto;
    }

    .feature-card {
      background: white;
      border-radius: var(--border-radius);
      padding: 25px;
      text-align: center;
      box-shadow: var(--box-shadow);
      transition: var(--transition);
    }

    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    }

    .feature-card i {
      font-size: 2.5rem;
      color: var(--primary);
      margin-bottom: 20px;
      background: #f0f4ff;
      width: 80px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      margin: 0 auto 20px;
    }

    .feature-card h3 {
      font-size: 1.4rem;
      margin-bottom: 15px;
      color: var(--dark);
    }

    .feature-card p {
      margin-bottom: 20px;
      color: var(--gray);
    }

    /* PDF Editing Guide Section */
    .guide-section {
      background: white;
      border-radius: var(--border-radius);
      padding: 40px;
      margin: 40px auto;
      box-shadow: var(--box-shadow);
      text-align: center;
    }

    .guide-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 25px;
      justify-content: center;
    }

    .guide-card {
      padding: 25px;
      background: #f8f9ff;
      border-radius: var(--border-radius);
      text-align: center;
      transition: var(--transition);
    }

    .guide-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .guide-card h3 {
      font-size: 1.4rem;
      margin-bottom: 15px;
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .guide-card h3 i {
      font-size: 1.6rem;
    }

    .guide-card p {
      color: var(--gray);
      font-size: 1rem;
    }

    /* PDF Tools Section */
    .pdf-tools {
      padding: 0 0 70px;
    }

    .card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 30px;
      margin-bottom: 30px;
      transition: var(--transition);
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.1);
    }

    .tabs {
      display: flex;
      justify-content: center;
      margin: 0 0 30px;
      gap: 10px;
      flex-wrap: wrap;
    }

    .tab {
      padding: 12px 25px;
      cursor: pointer;
      background: var(--light-gray);
      border-radius: 50px;
      font-weight: 500;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1rem;
    }

    .tab.active {
      background: var(--primary);
      color: white;
    }

    .tab:hover:not(.active) {
      background: #dbe4ff;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .drag-drop-area {
      width: 100%;
      max-width: 500px;
      margin: 2em auto;
      padding: 2em;
      border: 2px dashed var(--light-gray);
      border-radius: var(--border-radius);
      background: white;
      color: var(--gray);
      cursor: pointer;
      transition: var(--transition);
      text-align: center;
      font-size: 1rem;
    }

    .drag-drop-area.drag-over {
      background: #e6f0fa;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    .file-list {
      width: 100%;
      max-width: 500px;
      margin: 1em auto;
      padding: 15px;
      background: var(--light);
      border-radius: var(--border-radius);
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px;
      border-bottom: 1px solid #eee;
    }

    .file-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .file-icon {
      color: var(--primary);
      font-size: 1.5rem;
    }

    .file-remove {
      color: #e74c3c;
      cursor: pointer;
      padding: 5px;
    }
    
    /* Page range controls */
    .page-range-container {
      max-width: 500px;
      margin: 20px auto;
      padding: 20px;
      background: #f8f9ff;
      border-radius: var(--border-radius);
      border: 1px solid var(--light-gray);
    }
    
    .range-input-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .range-input-group label {
      font-weight: 500;
      color: var(--dark);
      margin-bottom: 5px;
    }
    
    .range-input-group input {
      padding: 12px 15px;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid var(--light-gray);
      background: white;
      transition: var(--transition);
    }
    
    .range-input-group input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }
    
    .range-info {
      background: #e6f0ff;
      padding: 15px;
      border-radius: 10px;
      margin-top: 15px;
      font-size: 0.9rem;
      color: var(--primary-dark);
    }
    
    .range-info i {
      margin-right: 8px;
    }
    
    /* Conversion settings */
    .conversion-settings {
      max-width: 500px;
      margin: 20px auto;
      padding: 20px;
      background: #f8f9ff;
      border-radius: var(--border-radius);
      border: 1px solid var(--light-gray);
    }
    
    .setting-group {
      margin-bottom: 20px;
    }
    
    .setting-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--dark);
    }
    
    .setting-group select, 
    .setting-group input {
      width: 100%;
      padding: 12px 15px;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid var(--light-gray);
      background: white;
      transition: var(--transition);
    }
    
    .setting-group select:focus, 
    .setting-group input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }
    
    .page-range-controls {
      display: flex;
      gap: 15px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .page-range-controls input, .page-range-controls select {
      flex: 1;
      min-width: 120px;
      padding: 15px;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid var(--light-gray);
      background: white;
      transition: var(--transition);
    }

    .page-range-controls input:focus, .page-range-controls select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    .progress-container {
      width: 100%;
      max-width: 500px;
      margin: 1.5em auto;
      padding: 15px;
      background: var(--light);
      border-radius: var(--border-radius);
      display: none;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
    }

    .progress-bar {
      height: 10px;
      background: var(--light-gray);
      border-radius: 5px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      border-radius: 5px;
      transition: width 0.4s ease;
    }

    .result-container {
      width: 100%;
      max-width: 500px;
      margin: 1.5em auto;
      padding: 1.2rem;
      background: rgba(39, 174, 96, 0.08);
      border: 1px dashed #27ae60;
      border-radius: var(--border-radius);
      display: none;
      text-align: center;
    }
    
    .result-container.split {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }
    
    .result-container.convert {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    .download-btn {
      background: #27ae60;
      color: white;
      padding: 15px;
      border-radius: 10px;
      text-decoration: none;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      transition: var(--transition);
      margin-top: 15px;
      cursor: pointer;
      width: 100%;
      justify-content: center;
      text-align: center;
    }

    .download-btn:hover, .download-btn:focus {
      background: #219653;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }
    
    .download-btn.split {
      background: var(--primary);
      max-width: 300px;
    }
    
    .download-btn.split:hover, .download-btn.split:focus {
      background: var(--primary-dark);
    }
    
    .download-btn.convert {
      background: var(--secondary);
      max-width: 300px;
    }
    
    .download-btn.convert:hover, .download-btn.convert:focus {
      background: #6517a0;
    }

    button {
      background: var(--primary);
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
      padding: 15px 20px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: var(--transition);
      border-radius: 10px;
      margin: 0.5em 0;
    }

    button:hover, button:focus {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    .btn-secondary {
      background: var(--secondary);
    }

    .btn-secondary:hover, .btn-secondary:focus {
      background: #6517a0;
      outline: 2px solid var(--secondary);
      outline-offset: 2px;
    }

    .loading {
      text-align: center;
      padding: 20px;
      display: none;
    }

    .spinner {
      border: 4px solid rgba(0, 0, 0, 0.1);
      border-left-color: var(--primary);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .error {
      color: #e74c3c;
      padding: 15px;
      background: rgba(231, 76, 60, 0.1);
      border-radius: var(--border-radius);
      margin: 20px 0;
      border-left: 4px solid #e74c3c;
      display: none;
    }

    .success {
      color: #27ae60;
      padding: 15px;
      background: rgba(39, 174, 96, 0.1);
      border-radius: var(--border-radius);
      margin: 20px 0;
      border-left: 4px solid #27ae60;
      display: none;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .guide-grid {
        grid-template-columns: 1fr;
      }
      
      .features-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .page-range-container,
      .conversion-settings {
        padding: 15px;
      }
      
      .range-input-group {
        flex-direction: column;
      }
    }

    @media (max-width: 576px) {
      .header-container {
        padding: 15px 0;
      }
      
      .logo {
        font-size: 1.5rem;
      }
      
      .logo i {
        font-size: 1.8rem;
      }
      
      .guide-section, .uses-section {
        padding: 30px;
      }
      
      .main-header .logo {
        font-size: 3rem;
      }
      
      .main-header h1 {
        font-size: 2rem;
      }
    }
    /* ========== END PDF TOOLS SPECIFIC STYLES ========== */
  </style>
</head>
<body>
  <!-- Header Placeholder -->
  <header id="main-header">
    <p class="error-message" style="display: none; color: red; text-align: center;">Failed to load header. Please try refreshing the page.</p>
  </header>

  <!-- Main Header Section -->
  <section class="main-header">
    <div class="container">
      <div class="logo">
        <i class="fas fa-file-pdf"></i>
      </div>
      <h1>PDF Tools</h1>
      <p class="tagline">Merge, split, compress, and convert PDFs with our free online tools.</p>
      <p class="tagline">100% secure and browser-based, no sign-up required.</p>
    </div>
  </section>

  <!-- PDF Tools Section -->
  <section class="pdf-tools" id="pdf-tools">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">PDF Tools</h2>
      </div>
      
      <div class="card">
        <div class="tabs">
          <div class="tab active" data-tab="merge" role="tab" aria-selected="true" tabindex="0">
            <i class="fas fa-object-group"></i> Merge PDFs
          </div>
          <div class="tab" data-tab="split" role="tab" aria-selected="false" tabindex="0">
            <i class="fas fa-cut"></i> Split PDF
          </div>
          <div class="tab" data-tab="compress" role="tab" aria-selected="false" tabindex="0">
            <i class="fas fa-compress-alt"></i> Compress PDF
          </div>
          <div class="tab" data-tab="convert" role="tab" aria-selected="false" tabindex="0">
            <i class="fas fa-exchange-alt"></i> Convert PDF
          </div>
        </div>

        <div class="tab-content active" id="merge-tab" role="tabpanel">
          <h2><i class="fas fa-object-group"></i> Merge PDF Files</h2>
          <p>Combine multiple PDF files into one document in seconds.</p>
          
          <div class="drag-drop-area" id="mergeUploadArea">
            <p><i class="fas fa-cloud-upload-alt fa-2x"></i></p>
            <p><strong>Choose file or drag and drop here</strong></p>
            <p>Supported formats: PDF</p>
            <p>Max file size: 100MB</p>
          </div>
          <input type="file" id="mergeFileUpload" accept=".pdf" multiple style="display: none;" aria-label="Upload PDF files for merging" />
          
          <div class="file-list" id="mergeFileList"></div>
          
          <div class="btn-group">
            <button id="mergeBtn" disabled>
              <i class="fas fa-object-group"></i> Merge PDFs
            </button>
            <button id="clearMergeBtn" class="btn-secondary">
              <i class="fas fa-trash"></i> Clear All
            </button>
          </div>
          
          <div class="loading" id="mergeLoading">
            <div class="spinner"></div>
            Merging your PDF files...
          </div>
          
          <div class="error" id="mergeError"></div>
          <div class="success" id="mergeSuccess"></div>
          
          <div id="mergeResult" class="result-container">
            <p>PDFs merged successfully!</p>
            <a id="mergeDownloadLink" class="download-btn"><i class="fas fa-download"></i> Download Merged PDF</a>
          </div>
        </div>
        
        <!-- Split PDF Tab -->
        <div class="tab-content" id="split-tab" role="tabpanel">
          <h2><i class="fas fa-cut"></i> Split PDF File</h2>
          <p>Extract specific pages or split your PDF into multiple files.</p>
          
          <div class="drag-drop-area" id="splitUploadArea">
            <p><i class="fas fa-cloud-upload-alt fa-2x"></i></p>
            <p><strong>Choose file or drag and drop here</strong></p>
            <p>Supported formats: PDF</p>
            <p>Max file size: 100MB</p>
          </div>
          <input type="file" id="splitFileUpload" accept=".pdf" style="display: none;" aria-label="Upload PDF file for splitting" />
          
          <div class="file-list" id="splitFileList"></div>
          
          <div class="page-range-container">
            <div class="range-input-group">
              <label for="splitRange">Page Range <span id="totalPages">(Total pages: -)</span></label>
              <input type="text" id="splitRange" placeholder="e.g., 1-3,5,7-9" aria-label="Enter page range to extract">
              <div class="range-info">
                <i class="fas fa-info-circle"></i> Enter page numbers separated by commas. Use hyphens for ranges (e.g., 1-3,5,7-9)
              </div>
            </div>
          </div>
          
          <div class="btn-group">
            <button id="splitBtn" disabled>
              <i class="fas fa-cut"></i> Split PDF
            </button>
            <button id="clearSplitBtn" class="btn-secondary">
              <i class="fas fa-trash"></i> Clear
            </button>
          </div>
          
          <div class="loading" id="splitLoading">
            <div class="spinner"></div>
            Splitting your PDF file...
          </div>
          
          <div class="error" id="splitError"></div>
          <div class="success" id="splitSuccess"></div>
          
          <div id="splitResult" class="result-container split" style="display: none;">
            <p>PDF split successfully!</p>
            <p>Your document has been split into <span id="splitCount">1</span> file.</p>
            <a id="splitDownloadLink" class="download-btn split"><i class="fas fa-download"></i> Download Split PDF</a>
          </div>
        </div>

        <div class="tab-content" id="compress-tab" role="tabpanel">
          <h2><i class="fas fa-compress-alt"></i> Compress PDF</h2>
          <p>Reduce PDF file size while maintaining quality.</p>
          
          <div class="drag-drop-area" id="compressUploadArea">
            <p><i class="fas fa-cloud-upload-alt fa-2x"></i></p>
            <p><strong>Choose file or drag and drop here</strong></p>
            <p>Supported formats: PDF</p>
            <p>Max file size: 100MB</p>
          </div>
          <input type="file" id="compressFileUpload" accept=".pdf" style="display: none;" aria-label="Upload PDF file for compression" />
          
          <div class="file-list" id="compressFileList"></div>
          
          <div class="setting-group">
            <p class="description">Select compression level to balance file size and quality.</p>
            <select id="compressionLevel" aria-label="Compression level">
              <option value="low">Low Compression (Better Quality)</option>
              <option value="medium" selected>Medium Compression (Recommended)</option>
              <option value="high">High Compression (Smaller File)</option>
            </select>
          </div>
          
          <div class="btn-group">
            <button id="compressBtn" disabled>
              <i class="fas fa-compress-alt"></i> Compress PDF
            </button>
            <button id="clearCompressBtn" class="btn-secondary">
              <i class="fas fa-trash"></i> Clear
            </button>
          </div>
          
          <div class="loading" id="compressLoading">
            <div class="spinner"></div>
            Compressing your PDF file...
          </div>
          
          <div class="progress-container" id="compressProgressContainer">
            <div class="progress-header">
              <span>Compression Progress</span>
              <span id="compressProgressPercent">0%</span>
            </div>
            <div class="progress-bar">
              <div id="compressProgressFill" class="progress-fill"></div>
            </div>
          </div>
          
          <div class="error" id="compressError"></div>
          <div class="success" id="compressSuccess"></div>
          
          <div id="compressResult" class="result-container">
            <p>PDF compressed successfully! Size reduced by <span id="sizeReduction">65%</span></p>
            <a id="compressDownloadLink" class="download-btn"><i class="fas fa-download"></i> Download Compressed PDF</a>
          </div>
        </div>

        <div class="tab-content" id="convert-tab" role="tabpanel">
          <h2><i class="fas fa-exchange-alt"></i> Convert PDF</h2>
          <p>Convert between PDF and image formats.</p>
          
          <div class="drag-drop-area" id="convertUploadArea">
            <p><i class="fas fa-cloud-upload-alt fa-2x"></i></p>
            <p><strong>Choose file or drag and drop here</strong></p>
            <p>Supported formats: PDF, JPG, PNG</p>
            <p>Max file size: 100MB</p>
          </div>
          <input type="file" id="convertFileUpload" accept=".pdf,.jpg,.jpeg,.png" style="display: none;" aria-label="Upload file for conversion" />
          
          <div class="file-list" id="convertFileList"></div>
          
          <div class="conversion-settings">
            <div class="setting-group">
              <label for="conversionDirection">Conversion Type</label>
              <div id="conversionDirection" style="padding: 15px; background: #f0f4ff; border-radius: 10px; margin-top: 10px; text-align: center; font-weight: 500;">
                Upload a file to begin
              </div>
            </div>
            
            <div class="setting-group" id="pdfToImageSettings">
              <label for="pageSelection">Page to Convert</label>
              <select id="pageSelection" aria-label="Select page to convert">
                <option value="1">Page 1</option>
              </select>
              <p class="description">Only the first page will be converted to an image</p>
            </div>
            
            <div class="setting-group" id="imageToPdfSettings">
              <label for="imageQuality">Image Quality</label>
              <select id="imageQuality" aria-label="Select image quality">
                <option value="high">High Quality</option>
                <option value="medium" selected>Medium Quality</option>
                <option value="low">Low Quality</option>
              </select>
            </div>
          </div>
          
          <div class="btn-group">
            <button id="convertBtn" disabled>
              <i class="fas fa-exchange-alt"></i> Convert File
            </button>
            <button id="clearConvertBtn" class="btn-secondary">
              <i class="fas fa-trash"></i> Clear
            </button>
          </div>
          
          <div class="loading" id="convertLoading">
            <div class="spinner"></div>
            Converting your file...
          </div>
          
          <div class="error" id="convertError"></div>
          <div class="success" id="convertSuccess"></div>
          
          <div id="convertResult" class="result-container convert" style="display: none;">
            <p>File converted successfully!</p>
            <a id="convertDownloadLink" class="download-btn convert"><i class="fas fa-download"></i> Download Converted File</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer Placeholder -->
  <footer id="main-footer">
    <p class="error-message" style="display: none; color: red; text-align: center;">Failed to load footer. Please try refreshing the page.</p>
  </footer>

  <!-- Cookie Consent Banner -->
  <div id="cookie-consent" role="dialog" aria-labelledby="cookie-consent-banner" aria-describedby="cookie-consent-desc">
    <div class="sr-only" id="cookie-consent-banner">Cookie Consent</div>
    <div class="cookie-content" id="cookie-consent-desc">
      <div class="cookie-text">
        <p>We use cookies to enhance your experience and analyze site traffic. By clicking "Accept All", you consent to our use of cookies. 
          <a href="/privacy-policy.html" aria-label="Learn more about our Privacy Policy">Learn more</a> in our Privacy Policy.
        </p>
        <button class="cookie-settings-btn" id="open-settings" aria-label="Open cookie settings">Cookie Settings</button>
      </div>
      <div class="cookie-buttons">
        <button class="cookie-btn reject-btn" id="reject-cookies" aria-label="Reject non-essential cookies">Reject Non-Essential</button>
        <button class="cookie-btn accept-btn" id="accept-cookies" aria-label="Accept all cookies">Accept All</button>
      </div>
    </div>
  </div>

  <!-- Cookie Settings Modal -->
  <div id="cookie-settings" role="dialog" aria-labelledby="cookie-settings-title" aria-describedby="cookie-settings-desc">
    <div class="settings-modal">
      <div class="settings-header">
        <h2 id="cookie-settings-title"><i class="fas fa-cookie-bite"></i> Cookie Settings</h2>
        <button class="close-settings" id="close-settings" aria-label="Close cookie settings">×</button>
      </div>
      <div class="settings-content">
        <p id="cookie-settings-desc">You can set your preferences for how we and our partners use cookies and similar technologies.</p>
        
        <div class="cookie-type">
          <div class="cookie-type-header">
            <h3>Essential Cookies</h3>
            <label class="toggle-switch" for="essential-toggle">
              <input type="checkbox" id="essential-toggle" checked disabled aria-label="Essential cookies (always enabled, cannot be disabled)" aria-describedby="essential-desc">
              <span class="slider"></span>
            </label>
          </div>
          <p id="essential-desc">These cookies are necessary for the website to function and cannot be switched off.</p>
        </div>
        
        <div class="cookie-type">
          <div class="cookie-type-header">
            <h3>Analytics Cookies</h3>
            <label class="toggle-switch" for="analytics-toggle">
              <input type="checkbox" id="analytics-toggle" aria-label="Analytics cookies toggle" aria-describedby="analytics-desc">
              <span class="slider"></span>
            </label>
          </div>
          <p id="analytics-desc">These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site.</p>
        </div>
        
        <div class="cookie-type">
          <div class="cookie-type-header">
            <h3>Advertising Cookies</h3>
            <label class="toggle-switch" for="advertising-toggle">
              <input type="checkbox" id="advertising-toggle" aria-label="Advertising cookies toggle" aria-describedby="advertising-desc">
              <span class="slider"></span>
            </label>
          </div>
          <p id="advertising-desc">These cookies may be set through our site by our advertising partners to build a profile of your interests.</p>
        </div>
      </div>
      <div class="settings-buttons">
        <button class="save-settings" id="save-settings" aria-label="Save cookie settings">Save Settings</button>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="/js/main.js"></script>
  <script>
    // Set up PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

    // PDF Tools Functionality
    function initPDFTools() {
      // State
      let state = {
        uploadedFiles: {},
        activeTab: 'merge',
        splitTotalPages: 0,
        pdfTotalPages: 0
      };

      // Switch tabs
      function switchTab(tabName) {
        document.querySelectorAll('.tab').forEach(tab => {
          tab.classList.remove('active');
          tab.setAttribute('aria-selected', 'false');
        });
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        
        const tab = document.querySelector(`.tab[data-tab="${tabName}"]`);
        const content = document.getElementById(`${tabName}-tab`);
        if (tab) {
          tab.classList.add('active');
          tab.setAttribute('aria-selected', 'true');
        }
        if (content) content.classList.add('active');
        state.activeTab = tabName;
      }

      // Set up file upload areas
      function setupFileUpload(areaId, inputId, listId) {
        const area = document.getElementById(areaId);
        const input = document.getElementById(inputId);
        const list = document.getElementById(listId);
        
        area.addEventListener('click', () => input.click());
        area.addEventListener('dragover', (e) => {
          e.preventDefault();
          area.classList.add('drag-over');
        });
        area.addEventListener('dragenter', (e) => {
          e.preventDefault();
          area.classList.add('drag-over');
        });
        area.addEventListener('dragleave', () => {
          area.classList.remove('drag-over');
        });
        area.addEventListener('drop', (e) => {
          e.preventDefault();
          area.classList.remove('drag-over');
          const files = e.dataTransfer.files;
          if (files.length > 0) {
            // For merge: append files instead of replacing
            if (listId === 'mergeFileList') {
              const existingFiles = state.uploadedFiles[listId] || [];
              const newFiles = Array.from(files);
              state.uploadedFiles[listId] = [...existingFiles, ...newFiles];
              renderFileList(listId);
            } else {
              input.files = files;
              handleFiles(input.files, listId);
            }
          }
        });
        
        input.addEventListener('change', () => {
          if (input.files.length > 0) {
            // For merge: append files instead of replacing
            if (listId === 'mergeFileList') {
              const existingFiles = state.uploadedFiles[listId] || [];
              const newFiles = Array.from(input.files);
              state.uploadedFiles[listId] = [...existingFiles, ...newFiles];
              renderFileList(listId);
            } else {
              handleFiles(input.files, listId);
            }
          }
        });
      }
      
      // Render file list (for merge specifically)
      function renderFileList(listId) {
        const list = document.getElementById(listId);
        const files = state.uploadedFiles[listId] || [];
        list.innerHTML = '';
        
        files.forEach((file, i) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';
          
          // Determine file icon
          let fileIcon = 'fa-file';
          if (file.type === 'application/pdf') {
            fileIcon = 'fa-file-pdf';
          } else if (file.type.startsWith('image/')) {
            fileIcon = 'fa-file-image';
          }
          
          fileItem.innerHTML = `
            <div class="file-info">
              <div class="file-icon"><i class="fas ${fileIcon}"></i></div>
              <div>
                <div>${file.name}</div>
                <div class="file-size">${formatFileSize(file.size)}</div>
              </div>
            </div>
            <div class="file-remove" data-index="${i}"><i class="fas fa-times"></i></div>
          `;
          list.appendChild(fileItem);
        });
        
        // Add remove functionality
        document.querySelectorAll(`#${listId} .file-remove`).forEach(removeBtn => {
          removeBtn.addEventListener('click', function() {
            const index = parseInt(this.getAttribute('data-index'));
            state.uploadedFiles[listId].splice(index, 1);
            renderFileList(listId);
            updateProcessButtonState(listId);
            
            // For conversion tab, reset direction if no files
            if (listId === 'convertFileList' && state.uploadedFiles[listId].length === 0) {
              document.getElementById('conversionDirection').textContent = 'Upload a file to begin';
              document.getElementById('pdfToImageSettings').style.display = 'none';
              document.getElementById('imageToPdfSettings').style.display = 'none';
            }
          });
        });
        
        updateProcessButtonState(listId);
      }
      
      // Handle uploaded files (for non-merge tabs)
      function handleFiles(files, listId) {
        state.uploadedFiles[listId] = Array.from(files);
        renderFileList(listId);
        
        // For conversion tab, update the conversion direction
        if (listId === 'convertFileList' && files.length > 0) {
          updateConversionDirection(files[0]);
        }
        
        // For split tab, get total pages
        if (listId === 'splitFileList' && files.length > 0 && files[0].type === 'application/pdf') {
          getPDFPageCount(files[0]).then(pageCount => {
            state.splitTotalPages = pageCount;
            document.getElementById('totalPages').textContent = `(Total pages: ${pageCount})`;
          }).catch(error => {
            console.error('Failed to get page count:', error);
            document.getElementById('totalPages').textContent = '(Total pages: unknown)';
          });
        }
      }
      
      // Get PDF page count
      async function getPDFPageCount(file) {
        const { PDFDocument } = PDFLib;
        const arrayBuffer = await file.arrayBuffer();
        const pdfDoc = await PDFDocument.load(arrayBuffer);
        return pdfDoc.getPageCount();
      }
      
      // Update conversion direction based on file type
      async function updateConversionDirection(file) {
        const directionEl = document.getElementById('conversionDirection');
        
        if (file.type === 'application/pdf') {
          directionEl.innerHTML = '<i class="fas fa-file-pdf"></i> PDF → <i class="fas fa-file-image"></i> Image';
          directionEl.style.color = '#4361ee';
          
          // Get PDF page count
          const pageCount = await getPDFPageCount(file);
          state.pdfTotalPages = pageCount;
          
          // Update page selection dropdown
          const pageSelect = document.getElementById('pageSelection');
          pageSelect.innerHTML = '';
          for (let i = 1; i <= Math.min(pageCount, 10); i++) {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = `Page ${i}`;
            pageSelect.appendChild(option);
          }
          
          document.getElementById('pdfToImageSettings').style.display = 'block';
          document.getElementById('imageToPdfSettings').style.display = 'none';
        } else if (file.type.startsWith('image/')) {
          directionEl.innerHTML = '<i class="fas fa-file-image"></i> Image → <i class="fas fa-file-pdf"></i> PDF';
          directionEl.style.color = '#7209b7';
          document.getElementById('pdfToImageSettings').style.display = 'none';
          document.getElementById('imageToPdfSettings').style.display = 'block';
        } else {
          directionEl.textContent = 'Unsupported file type';
          directionEl.style.color = '#e74c3c';
          document.getElementById('pdfToImageSettings').style.display = 'none';
          document.getElementById('imageToPdfSettings').style.display = 'none';
        }
      }
      
      // Format file size
      function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
      }
      
      // Update process button state
      function updateProcessButtonState(listId) {
        const tool = state.activeTab;
        const hasFiles = state.uploadedFiles[listId] && state.uploadedFiles[listId].length > 0;
        
        if (tool === 'merge') {
          document.getElementById('mergeBtn').disabled = !hasFiles || state.uploadedFiles[listId].length < 2;
        } else {
          document.getElementById(`${tool}Btn`).disabled = !hasFiles;
        }
        
        // For split tab, also require a valid range
        if (tool === 'split') {
          const rangeInput = document.getElementById('splitRange');
          const range = rangeInput.value.trim();
          const hasValidRange = range !== '' && validatePageRange(range, state.splitTotalPages);
          document.getElementById('splitBtn').disabled = !hasFiles || !hasValidRange;
        }
      }

      // Show error message
      function showError(tool, message) {
        const element = document.getElementById(`${tool}Error`);
        element.textContent = message;
        element.style.display = 'block';
        document.getElementById(`${tool}Loading`).style.display = 'none';
      }

      // Show success message
      function showSuccess(tool, message) {
        const element = document.getElementById(`${tool}Success`);
        element.textContent = message;
        element.style.display = 'block';
        document.getElementById(`${tool}Loading`).style.display = 'none';
      }

      // Hide messages
      function hideMessages(tool) {
        document.getElementById(`${tool}Error`).style.display = 'none';
        document.getElementById(`${tool}Success`).style.display = 'none';
      }

      // Show loading state
      function showLoading(tool) {
        hideMessages(tool);
        document.getElementById(`${tool}Loading`).style.display = 'block';
        document.getElementById(`${tool}Result`).style.display = 'none';
      }

      // Hide loading state
      function hideLoading(tool) {
        document.getElementById(`${tool}Loading`).style.display = 'none';
      }

      // Update progress bar
      function updateProgress(tool, percent) {
        const percentValue = Math.min(100, Math.max(0, percent));
        if(tool === 'compress') {
          document.getElementById('compressProgressFill').style.width = `${percentValue}%`;
          document.getElementById('compressProgressPercent').textContent = `${Math.round(percentValue)}%`;
        }
      }

      // Create and download a file
      function downloadFile(blob, fileName) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      // Parse page range string
      function parseRange(rangeStr, totalPages) {
        const pages = new Set();
        const ranges = rangeStr.split(',');
        
        for (const range of ranges) {
          if (range.includes('-')) {
            const [start, end] = range.split('-').map(Number);
            const min = Math.max(1, Math.min(start, end));
            const max = Math.min(totalPages, Math.max(start, end));
            
            for (let i = min; i <= max; i++) {
              pages.add(i - 1); // Convert to 0-indexed
            }
          } else {
            const page = parseInt(range.trim());
            if (!isNaN(page) && page >= 1 && page <= totalPages) {
              pages.add(page - 1); // Convert to 0-indexed
            }
          }
        }
        
        return Array.from(pages).sort((a, b) => a - b);
      }
      
      // Validate page range
      function validatePageRange(rangeStr, totalPages) {
        if (!rangeStr) return false;
        
        const ranges = rangeStr.split(',');
        for (const range of ranges) {
          if (range.includes('-')) {
            const [start, end] = range.split('-').map(Number);
            if (isNaN(start) || isNaN(end) || start < 1 || end > totalPages || start > end) {
              return false;
            }
          } else {
            const page = parseInt(range.trim());
            if (isNaN(page) || page < 1 || page > totalPages) {
              return false;
            }
          }
        }
        return true;
      }

      // Process functions
      async function processMerge() {
        const files = state.uploadedFiles.mergeFileList;
        if (!files || files.length < 2) {
          showError('merge', 'Please upload at least 2 PDF files to merge');
          return;
        }
        
        try {
          showLoading('merge');
          
          // Create a new PDF document
          const { PDFDocument } = PDFLib;
          const mergedPdf = await PDFDocument.create();
          
          // Merge all PDFs
          for (const file of files) {
            const fileBytes = await file.arrayBuffer();
            const pdf = await PDFDocument.load(fileBytes);
            const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
            pages.forEach(page => mergedPdf.addPage(page));
          }
          
          // Save merged PDF
          const mergedPdfBytes = await mergedPdf.save();
          const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
          
          // Update UI
          const downloadLink = document.getElementById('mergeDownloadLink');
          downloadLink.onclick = () => downloadFile(blob, 'merged-document.pdf');
          document.getElementById('mergeResult').style.display = 'block';
          hideLoading('merge');
          showSuccess('merge', 'PDFs merged successfully!');
        } catch (error) {
          showError('merge', `Failed to merge PDFs: ${error.message}`);
        }
      }
      
      // Process Split PDF
      async function processSplit() {
        const files = state.uploadedFiles.splitFileList;
        if (!files || files.length === 0) {
          showError('split', 'Please upload a PDF file to split');
          return;
        }
        
        const rangeInput = document.getElementById('splitRange').value.trim();
        if (!rangeInput) {
          showError('split', 'Please enter a valid page range');
          return;
        }
        
        if (!validatePageRange(rangeInput, state.splitTotalPages)) {
          showError('split', `Invalid page range. Please enter pages between 1 and ${state.splitTotalPages}`);
          return;
        }
        
        try {
          showLoading('split');
          
          const { PDFDocument } = PDFLib;
          const file = files[0];
          const fileBytes = await file.arrayBuffer();
          const pdfDoc = await PDFDocument.load(fileBytes);
          
          // Parse page range
          const pageIndices = parseRange(rangeInput, state.splitTotalPages);
          
          // Create new PDF with selected pages
          const newPdf = await PDFDocument.create();
          const pages = await newPdf.copyPages(pdfDoc, pageIndices);
          pages.forEach(page => newPdf.addPage(page));
          
          // Save new PDF
          const newPdfBytes = await newPdf.save();
          const blob = new Blob([newPdfBytes], { type: 'application/pdf' });
          
          // Update UI
          const downloadLink = document.getElementById('splitDownloadLink');
          downloadLink.onclick = () => downloadFile(blob, `split-document-pages-${rangeInput.replace(/,/g, '-')}.pdf`);
          document.getElementById('splitCount').textContent = '1';
          document.getElementById('splitResult').style.display = 'flex';
          hideLoading('split');
          showSuccess('split', `PDF split successfully! Extracted ${pageIndices.length} pages.`);
        } catch (error) {
          showError('split', `Failed to split PDF: ${error.message}`);
        }
      }
      
      async function processCompress() {
        const files = state.uploadedFiles.compressFileList;
        if (!files || files.length === 0) {
          showError('compress', 'Please upload a PDF file to compress');
          return;
        }
        
        try {
          showLoading('compress');
          document.getElementById('compressProgressContainer').style.display = 'block';
          
          // Simulate compression progress
          let progress = 0;
          const progressInterval = setInterval(() => {
            progress += 10;
            updateProgress('compress', progress);
            if (progress >= 100) {
              clearInterval(progressInterval);
            }
          }, 200);
          
          // Load PDF document
          const file = files[0];
          const fileBytes = await file.arrayBuffer();
          const { PDFDocument } = PDFLib;
          const pdfDoc = await PDFDocument.load(fileBytes);
          
          // Save as compressed PDF
          const compressedBytes = await pdfDoc.save({ useObjectStreams: true });
          const blob = new Blob([compressedBytes], { type: 'application/pdf' });
          
          // Calculate size reduction
          const originalSize = file.size;
          const compressedSize = blob.size;
          const reduction = Math.round(((originalSize - compressedSize) / originalSize) * 100);
          
          // Update UI
          document.getElementById('sizeReduction').textContent = `${reduction}%`;
          const downloadLink = document.getElementById('compressDownloadLink');
          downloadLink.onclick = () => downloadFile(blob, 'compressed-document.pdf');
          document.getElementById('compressResult').style.display = 'block';
          hideLoading('compress');
          showSuccess('compress', `PDF compressed successfully! Size reduced by ${reduction}%`);
        } catch (error) {
          showError('compress', `Failed to compress PDF: ${error.message}`);
        }
      }
      
      // Improved PDF conversion with PDF.js
      async function processConvert() {
        const files = state.uploadedFiles.convertFileList;
        if (!files || files.length === 0) {
          showError('convert', 'Please upload a file to convert');
          return;
        }
        
        try {
          showLoading('convert');
          const file = files[0];
          let blob, fileName;
          
          if (file.type === 'application/pdf') {
            // Get selected page
            const pageNum = parseInt(document.getElementById('pageSelection').value);
            
            // Load the PDF with PDF.js
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
            
            // Get the selected page
            const page = await pdf.getPage(pageNum);
            
            // Set scale (1.5 = 150% for better quality)
            const viewport = page.getViewport({ scale: 1.5 });
            
            // Create canvas for rendering
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.height = viewport.height;
            canvas.width = viewport.width;
            
            // Render PDF page to canvas
            const renderContext = {
              canvasContext: context,
              viewport: viewport
            };
            await page.render(renderContext).promise;
            
            // Convert canvas to JPEG
            const dataUrl = canvas.toDataURL('image/jpeg', 0.95);
            const res = await fetch(dataUrl);
            blob = await res.blob();
            fileName = `converted-page-${pageNum}.jpg`;
          } else if (file.type.startsWith('image/')) {
            // Convert image to PDF
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            
            // Create image element to get dimensions
            const img = new Image();
            const imgUrl = URL.createObjectURL(file);
            
            await new Promise((resolve) => {
              img.onload = resolve;
              img.src = imgUrl;
            });
            
            const width = img.width;
            const height = img.height;
            const ratio = width / height;
            
            // Calculate dimensions to fit in PDF
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = pdfWidth / ratio;
            
            // Get quality setting
            const quality = document.getElementById('imageQuality').value;
            let qualityValue = 0.95;
            if (quality === 'medium') qualityValue = 0.75;
            if (quality === 'low') qualityValue = 0.5;
            
            // Add image to PDF
            pdf.addImage(img, 'JPEG', 0, 0, pdfWidth, pdfHeight, null, 'FAST', 0, qualityValue);
            blob = pdf.output('blob');
            fileName = 'converted-document.pdf';
            
            URL.revokeObjectURL(imgUrl);
          } else {
            showError('convert', 'Unsupported file type for conversion');
            return;
          }
          
          // Update UI
          const downloadLink = document.getElementById('convertDownloadLink');
          downloadLink.onclick = () => downloadFile(blob, fileName);
          document.getElementById('convertResult').style.display = 'flex';
          hideLoading('convert');
          showSuccess('convert', 'File converted successfully!');
        } catch (error) {
          showError('convert', `Failed to convert file: ${error.message}`);
        }
      }

      // Initialize PDF tools
      function setupPDFTools() {
        // Set up tab switching
        document.querySelectorAll('.tab').forEach(tab => {
          tab.addEventListener('click', () => switchTab(tab.dataset.tab));
          tab.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              tab.click();
            }
          });
        });

        // Initialize file upload areas
        setupFileUpload('mergeUploadArea', 'mergeFileUpload', 'mergeFileList');
        setupFileUpload('splitUploadArea', 'splitFileUpload', 'splitFileList');
        setupFileUpload('compressUploadArea', 'compressFileUpload', 'compressFileList');
        setupFileUpload('convertUploadArea', 'convertFileUpload', 'convertFileList');

        // Clear buttons
        document.getElementById('clearMergeBtn').addEventListener('click', () => {
          state.uploadedFiles.mergeFileList = [];
          renderFileList('mergeFileList');
          hideMessages('merge');
          document.getElementById('mergeResult').style.display = 'none';
        });
        
        document.getElementById('clearSplitBtn').addEventListener('click', () => {
          state.uploadedFiles.splitFileList = [];
          renderFileList('splitFileList');
          document.getElementById('splitRange').value = '';
          state.splitTotalPages = 0;
          hideMessages('split');
          document.getElementById('splitResult').style.display = 'none';
          document.getElementById('totalPages').textContent = '(Total pages: -)';
        });
        
        document.getElementById('clearCompressBtn').addEventListener('click', () => {
          state.uploadedFiles.compressFileList = [];
          renderFileList('compressFileList');
          hideMessages('compress');
          document.getElementById('compressResult').style.display = 'none';
          document.getElementById('compressProgressContainer').style.display = 'none';
        });
        
        document.getElementById('clearConvertBtn').addEventListener('click', () => {
          state.uploadedFiles.convertFileList = [];
          renderFileList('convertFileList');
          hideMessages('convert');
          document.getElementById('convertResult').style.display = 'none';
          document.getElementById('conversionDirection').textContent = 'Upload a file to begin';
          document.getElementById('pdfToImageSettings').style.display = 'none';
          document.getElementById('imageToPdfSettings').style.display = 'none';
        });
        
        // Process buttons
        document.getElementById('mergeBtn').addEventListener('click', processMerge);
        document.getElementById('splitBtn').addEventListener('click', processSplit);
        document.getElementById('compressBtn').addEventListener('click', processCompress);
        document.getElementById('convertBtn').addEventListener('click', processConvert);
        
        // Validate split range input
        const splitRangeInput = document.getElementById('splitRange');
        if (splitRangeInput) {
          splitRangeInput.addEventListener('input', () => {
            updateProcessButtonState('splitFileList');
          });
        }
      }

      // Initialize when DOM is loaded
      setupPDFTools();
    }

    // Initialize PDF tools when DOM is loaded
    document.addEventListener('DOMContentLoaded', initPDFTools);
  </script>
</body>
</html>
